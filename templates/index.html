<html>
  <head>
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin="" />
    <link
      rel="stylesheet"
      as="style"
      onload="this.rel='stylesheet'"
      href="https://fonts.googleapis.com/css2?display=swap&amp;family=Inter%3Awght%40400%3B500%3B700%3B900&amp;family=Noto+Sans%3Awght%40400%3B500%3B700%3B900"
    />

    <title>Article Maker</title>
    <link rel="icon" type="image/x-icon" href="data:image/x-icon;base64," />

    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <style>
      @keyframes loadingDots {
        0% { content: '.'; }
        33% { content: '..'; }
        66% { content: '...'; }
        100% { content: '.'; }
      }
      
      .loading-dots {
        animation: loadingDots 1.5s infinite;
        display: inline-block;
        width: 20px;
      }

      /* Markdown Styles */
      .markdown-content {
        color: white;
        line-height: 1.6;
        overflow-y: auto;
        white-space: pre-line;  /* Changed from pre-wrap */
        word-wrap: break-word;
        width: 100%;
        max-width: 960px;
        display: flex;         /* Added */
        flex-direction: column; /* Added */
      }
      .markdown-content h1 { font-size: 1.8em; font-weight: bold; margin: 1em 0; }
      .markdown-content h2 { font-size: 1.5em; font-weight: bold; margin: 0.8em 0; }
      .markdown-content h3 { font-size: 1.3em; font-weight: bold; margin: 0.6em 0; }
      .markdown-content p { 
        margin: 1em 0;
        display: block;        /* Added */
        width: 100%;          /* Added */
      }
      .markdown-content ul, .markdown-content ol { margin: 1em 0; padding-left: 2em; }
      .markdown-content li { margin: 0.5em 0; }
      .markdown-content code {
        background: #2d2d2d;
        padding: 0.2em 0.4em;
        border-radius: 3px;
      }
      .markdown-content pre {
        background: #2d2d2d;
        padding: 1em;
        border-radius: 5px;
        overflow-x: auto;
      }
      .markdown-content blockquote {
        border-left: 4px solid #4d4d4d;
        padding-left: 1em;
        margin: 1em 0;
        color: #adadad;
      }

      .mode-buttons {
        display: flex;
        gap: 8px;
        margin-bottom: 8px;
      }

      .mode-button {
        padding: 4px 12px;
        border-radius: 6px;
        background: #2d2d2d;
        color: #adadad;
        cursor: pointer;
      }

      .mode-button.active {
        background: #4d4d4d;
        color: white;
      }

      .copy-button {
        position: absolute;
        top: 8px;
        right: 8px;
        padding: 4px 8px;
        border-radius: 4px;
        background: #2d2d2d;
        color: #adadad;
        font-size: 12px;
        cursor: pointer;
      }

      .copy-button:hover {
        background: #4d4d4d;
      }

      #editArea {
        display: none;
        width: 100%;
        min-height: 300px;
        background: transparent;
        color: white;
        border: none;
        resize: vertical;
      }
    </style>
  </head>
  <body>
    <div class="relative flex size-full min-h-screen flex-col bg-[#1a1a1a] dark group/design-root overflow-x-hidden" style='font-family: Inter, "Noto Sans", sans-serif;'>
      <div class="layout-container flex h-full grow flex-col">
        <div class="px-40 flex flex-1 justify-center py-5">
          <div class="layout-content-container flex flex-col max-w-[960px] flex-1">
            <div class="@container">
              <div class="@[480px]:p-4">
                <div
                  class="flex min-h-[200] flex-col gap-6 bg-cover bg-center bg-no-repeat @[220]:gap-8 @[200]:rounded-xl items-center justify-center p-4"
                  style='background-image: linear-gradient(rgba(0, 0, 0, 0.0) 0%, rgba(0, 0, 0, 0.0) 100%)'
                >
                  <div class="flex flex-col gap-2 text-center">
                    <h2
                      class="text-white text-2xl font-black leading-tight tracking-[-0.033em] @[480px]:text-3xl @[480px]:font-black @[480px]:leading-tight @[480px]:tracking-[-0.033em]"
                    >
                      Generate Medium-Quality Articles in Seconds
                    </h2>
                    <h3 class="text-white text-sm font-normal leading-normal @[480px]:text-base @[480px]:font-normal @[480px]:leading-normal">
                      Simply enter a topic, and our AI will craft a comprehensive, engaging article for you.
                    </h3>
                  </div>
                  <label class="flex flex-col min-w-40 h-14 w-full max-w-[480px] @[480px]:h-16">
                    <div class="flex w-full flex-1 items-stretch rounded-xl h-full">
                      <div
                        class="text-[#adadad] flex border border-[#4d4d4d] bg-neutral-800 items-center justify-center pl-[15px] rounded-l-xl border-r-0"
                        data-icon="MagnifyingGlass"
                        data-size="20px"
                        data-weight="regular"
                      >
                        <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" fill="currentColor" viewBox="0 0 256 256">
                          <path
                            d="M229.66,218.34l-50.07-50.06a88.11,88.11,0,1,0-11.31,11.31l50.06,50.07a8,8,0,0,0,11.32-11.32ZM40,112a72,72,0,1,1,72,72A72.08,72.08,0,0,1,40,112Z"
                          ></path>
                        </svg>
                      </div>
                      <input
                        id="topicInput"
                        placeholder="Enter Topic"
                        class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-xl text-white focus:outline-0 focus:ring-0 border border-[#4d4d4d] bg-neutral-800 focus:border-[#4d4d4d] h-full placeholder:text-[#adadad] px-[15px] rounded-r-none border-r-0 pr-2 rounded-l-none border-l-0 pl-2 text-sm font-normal leading-normal @[480px]:text-base @[480px]:font-normal @[480px]:leading-normal"
                        value=""
                      />
                      <div class="flex items-center justify-center rounded-r-xl border-l-0 border border-[#4d4d4d] bg-neutral-800 pr-[7px]">
                        <button
                          id="generateButton"
                          class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-full h-10 px-4 @[480px]:h-12 @[480px]:px-5 bg-white text-[#1a1a1a] text-sm font-bold leading-normal tracking-[0.015em] @[480px]:text-base @[480px]:font-bold @[480px]:leading-normal @[480px]:tracking-[0.015em]"
                        >
                          <span class="truncate">Start Generating</span>
                        </button>
                      </div>
                    </div>
                  </label>
                </div>
              </div>
            </div>
            <div class="flex flex-col gap-3 p-4" id="loadingSection" style="display: none;">
              <div class="flex gap-6 justify-between">
                <div class="text-white text-base font-medium leading-normal flex items-center gap-3">
  <svg class="animate-spin h-6 w-6 text-blue-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"></path>
  </svg>
  Crafting your article...
</div>
              </div>
              <p class="text-[#adadad] text-sm font-normal leading-normal">This may take a few moments.</p>
            </div>
            <div class="flex max-w-[960px] w-full flex-wrap items-start gap-4 px-4 py-3">
              <div class="flex flex-col w-full">
                <div class="mode-buttons">
                  <button class="mode-button active" data-mode="preview">Preview</button>
                  <button class="mode-button" data-mode="edit">Edit</button>
                </div>
                <div class="relative">
                  <div
                    id="outputArea"
                    class="form-input w-full overflow-auto rounded-xl text-white focus:outline-0 focus:ring-0 border border-[#4d4d4d] bg-neutral-800 focus:border-[#4d4d4d] min-h-36 p-[15px] markdown-content"
                  ></div>
                  <textarea
                    id="editArea"
                    class="form-input w-full overflow-auto rounded-xl text-white focus:outline-0 focus:ring-0 border border-[#4d4d4d] bg-neutral-800 focus:border-[#4d4d4d] min-h-36 p-[15px]"
                  ></textarea>
                  <button class="copy-button">Copy</button>
                </div>
              </div>
            </div>

          </div>
        </div>
      </div>
    </div>
    <script>
      const generateButton = document.querySelector('button');
      const input = document.querySelector('input[placeholder="Enter Topic"]');
      const loadingSection = document.getElementById('loadingSection');
      const output = document.getElementById('outputArea');
      const editArea = document.getElementById('editArea');
      const modeButtons = document.querySelectorAll('.mode-button');
      const copyButton = document.querySelector('.copy-button');

      let currentMode = 'preview';
      let currentContent = '';

      // Set marked options for better security
      marked.setOptions({
        breaks: true,
        sanitize: true
      });

      // Mode switching
      modeButtons.forEach(button => {
        button.addEventListener('click', () => {
          const mode = button.dataset.mode;
          if (mode === currentMode) return;

          modeButtons.forEach(btn => btn.classList.remove('active'));
          button.classList.add('active');
          currentMode = mode;

          if (mode === 'edit') {
            editArea.value = currentContent;
            editArea.style.display = 'block';
            output.style.display = 'none';
          } else {
            currentContent = editArea.value;
            output.innerHTML = marked.parse(currentContent);
            editArea.style.display = 'none';
            output.style.display = 'block';
          }
        });
      });

      // Copy button
      copyButton.addEventListener('click', async () => {
        const textToCopy = currentMode === 'edit' ? editArea.value : currentContent;
        await navigator.clipboard.writeText(textToCopy);
        
        const originalText = copyButton.textContent;
        copyButton.textContent = 'Copied!';
        setTimeout(() => {
          copyButton.textContent = originalText;
        }, 2000);
      });

      generateButton.addEventListener('click', async () => {
        const topic = input.value.trim();
        if (!topic) return;

        loadingSection.style.display = 'flex';
        output.innerHTML = '';
        editArea.value = '';
        
        try {
          const response = await fetch('/', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/x-www-form-urlencoded',
            },
            body: `topic=${encodeURIComponent(topic)}`
          });
          
          const data = await response.json();
          
          currentContent = data.article;
          output.innerHTML = marked.parse(currentContent);
          
          loadingSection.style.display = 'none';
        } catch (error) {
          console.error('Error:', error);
          output.innerHTML = 'An error occurred while generating the article.';
          loadingSection.style.display = 'none';
        }
      });

      // Edit area live preview
      editArea.addEventListener('input', () => {
        currentContent = editArea.value;
      });
    </script>
  </body>
</html>
